!function(){const t=document.getElementById("hamburger-menu-btn"),e=document.getElementById("hamburger-menu"),n=document.getElementById("menu-user-info"),i=document.getElementById("menu-username"),a=document.getElementById("menu-dashboard"),s=document.getElementById("menu-admin"),r=document.getElementById("menu-new-box"),d=document.getElementById("menu-sign-in"),o=document.getElementById("menu-sign-out");function l(){t.setAttribute("aria-expanded","false"),e.setAttribute("aria-hidden","true"),t.classList.remove("active"),e.classList.remove("active");e.querySelectorAll(".menu-item").forEach(t=>{t.setAttribute("tabindex","-1"),t.setAttribute("aria-hidden","true")})}async function u(e){if(e&&!e.isAnonymous){let l=e.displayName||e.email||"Unknown";if(l.includes("@")&&(l=l.split("@")[0]),window.functions)try{const t=`t4t_auth_${e.uid}`,n=sessionStorage.getItem(t);let a;if(null!==n)a="true"===n;else{const{httpsCallable:e}=await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-functions.js"),n=e(window.functions,"isAuthorizedVolunteerV2");a=(await n()).data.isAuthorized,sessionStorage.setItem(t,a?"true":"false")}a&&localStorage.setItem("t4t_wasAuthorized","true");const s=a?"":"*";i.textContent=`${l}${s}`}catch(t){i.textContent=l}else i.textContent=l;t.style.display="flex",n.style.display="block",a.style.display="block",s.style.display="block",r.style.display="block",o.style.display="block",d.style.display="none"}else{"true"===localStorage.getItem("t4t_wasAuthorized")?(t.style.display="flex",n.style.display="none",a.style.display="none",a.setAttribute("tabindex","-1"),a.setAttribute("aria-hidden","true"),s.style.display="none",s.setAttribute("tabindex","-1"),s.setAttribute("aria-hidden","true"),r.style.display="none",r.setAttribute("tabindex","-1"),r.setAttribute("aria-hidden","true"),o.style.display="none",o.setAttribute("tabindex","-1"),o.setAttribute("aria-hidden","true"),d.style.display="block"):(t.style.display="none",n.style.display="none",a.style.display="none",a.setAttribute("tabindex","-1"),a.setAttribute("aria-hidden","true"),s.style.display="none",s.setAttribute("tabindex","-1"),s.setAttribute("aria-hidden","true"),r.style.display="none",r.setAttribute("tabindex","-1"),r.setAttribute("aria-hidden","true"),o.style.display="none",o.setAttribute("tabindex","-1"),o.setAttribute("aria-hidden","true"),d.style.display="block",l())}}t&&t.addEventListener("click",function(){const n="true"===t.getAttribute("aria-expanded");t.setAttribute("aria-expanded",!n),e.setAttribute("aria-hidden",n),t.classList.toggle("active"),e.classList.toggle("active"),e.querySelectorAll(".menu-item").forEach(t=>{n?(t.setAttribute("tabindex","-1"),t.setAttribute("aria-hidden","true")):"none"!==t.style.display&&(t.removeAttribute("tabindex"),t.removeAttribute("aria-hidden"))})}),r&&r.addEventListener("click",function(t){t.preventDefault();const e=Math.floor(1e4+9e4*Math.random()).toString();window.location.href=`/setup?id=${e}`}),o&&o.addEventListener("click",async function(t){t.preventDefault();try{if(window.auth){const{signOut:t}=await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js");await t(window.auth)}window.location.href="/login"}catch(t){console.error("Sign out error:",t),window.location.href="/login"}}),document.addEventListener("click",n=>{e.contains(n.target)||t.contains(n.target)||l()});e.querySelectorAll(".menu-item").forEach(t=>{"menu-new-box"!==t.id&&"menu-sign-out"!==t.id&&t.addEventListener("click",l)});let c=0;!function t(){window.auth?(window.auth.onAuthStateChanged(t=>{u(t)}),window.auth.currentUser&&u(window.auth.currentUser)):c<20&&(c++,setTimeout(t,500))}()}();