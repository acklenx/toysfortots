!function(){const t=document.getElementById("hamburger-menu-btn"),e=document.getElementById("hamburger-menu"),n=document.getElementById("menu-user-info"),i=document.getElementById("menu-username"),a=document.getElementById("menu-dashboard"),s=document.getElementById("menu-admin"),o=document.getElementById("menu-new-box"),d=document.getElementById("menu-sign-in"),r=document.getElementById("menu-sign-out");function u(){t.setAttribute("aria-expanded","false"),e.setAttribute("aria-hidden","true"),t.classList.remove("active"),e.classList.remove("active");e.querySelectorAll(".menu-item").forEach(t=>{t.setAttribute("tabindex","-1"),t.setAttribute("aria-hidden","true")})}async function l(e){if(e&&!e.isAnonymous){let u=e.displayName||e.email||"Unknown";if(u.includes("@")&&(u=u.split("@")[0]),window.functions)try{const{httpsCallable:t}=await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-functions.js"),e=t(window.functions,"isAuthorizedVolunteerV2"),n=await e(),a=n.data.isAuthorized?"":"*";i.textContent=`${u}${a}`}catch(t){i.textContent=u}else i.textContent=u;t.style.display="flex",n.style.display="block",a.style.display="block",s.style.display="block",o.style.display="block",r.style.display="block",d.style.display="none"}else t.style.display="none",n.style.display="none",a.style.display="none",a.setAttribute("tabindex","-1"),a.setAttribute("aria-hidden","true"),s.style.display="none",s.setAttribute("tabindex","-1"),s.setAttribute("aria-hidden","true"),o.style.display="none",o.setAttribute("tabindex","-1"),o.setAttribute("aria-hidden","true"),r.style.display="none",r.setAttribute("tabindex","-1"),r.setAttribute("aria-hidden","true"),d.style.display="block",u()}t&&t.addEventListener("click",function(){const n="true"===t.getAttribute("aria-expanded");t.setAttribute("aria-expanded",!n),e.setAttribute("aria-hidden",n),t.classList.toggle("active"),e.classList.toggle("active"),e.querySelectorAll(".menu-item").forEach(t=>{n?(t.setAttribute("tabindex","-1"),t.setAttribute("aria-hidden","true")):"none"!==t.style.display&&(t.removeAttribute("tabindex"),t.removeAttribute("aria-hidden"))})}),o&&o.addEventListener("click",function(t){t.preventDefault();const e=Math.floor(1e4+9e4*Math.random()).toString();window.location.href=`/setup?id=${e}`}),r&&r.addEventListener("click",async function(t){t.preventDefault();try{if(window.auth){const{signOut:t}=await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js");await t(window.auth)}window.location.href="/login"}catch(t){console.error("Sign out error:",t),window.location.href="/login"}}),document.addEventListener("click",n=>{e.contains(n.target)||t.contains(n.target)||u()});e.querySelectorAll(".menu-item").forEach(t=>{"menu-new-box"!==t.id&&"menu-sign-out"!==t.id&&t.addEventListener("click",u)});let c=0;!function t(){window.auth?(window.auth.onAuthStateChanged(t=>{l(t)}),window.auth.currentUser&&l(window.auth.currentUser)):c<20&&(c++,setTimeout(t,500))}()}();